import{d as K,a as Q,u as W,b as X,e as x,r as ee,k as i,n as d,f as k,m as f,t as _,j as n,g as e,i as a,q as I,x as v,L as C,M as A,Y as j,T as L,E as w,Z as te,_ as ae}from"./index.a0fe722d.js";import{u as le,d as re,e as ne,f as oe,a as ue}from"./index.fea579a6.js";const se={class:"createPost-container"},ie={class:"title"},de={class:"createPost-main-container"},ce={class:"postInfo-container"},pe={class:"title"},me={class:"submit_order_button"},fe=K({__name:"index",setup(_e){const g=Q(),U=W(),{t:o}=X(),{area:N}=le(),b=(u,t)=>o(`transfer.${u}`)+" "+o(`${t}`),M=(u,t,s)=>{j(t,l.origin)?s(new Error("\u65B0\u5E93\u533A\u4E0D\u80FD\u4E0E\u539F\u5E93\u533A\u76F8\u540C\uFF01\uFF01")):s()},R=(u,t,s)=>{j(t,l.new)?s(new Error("\u539F\u5E93\u533A\u4E0D\u80FD\u65B0\u5E93\u533A\u4E0E\u76F8\u540C\uFF01\uFF01")):s()},T=x({origin:[{required:!0,message:b("origin","require"),trigger:"blur"},{required:!0,validator:R,trigger:"change"}],new:[{required:!0,message:b("new","require"),trigger:"blur"},{required:!0,validator:M,trigger:"change"}],correlationID:[{required:!0,message:b("correlationID","require"),trigger:"blur"}],batch:[{required:!0,message:b("batch","require"),trigger:"blur"}],documenter:[{required:!0,message:b("documenter","require"),trigger:"blur"}]}),O=ee(),l=x({orderID:"",correlationID:"",timestamp:"",batch:"",origin:"",new:"",documenter:"",remark:"",production:[]}),z=u=>{!u||u.validate(async t=>{if(t)(g.query.id?await re(l):await ne(l)).code===2e4&&(L({title:"Success",message:w.global.t("tips.submit")+w.global.t("tips.success"),type:"success",duration:2e3}),U.go(-1));else return L({title:"Error",message:w.global.t("tips.submit")+w.global.t("tips.fail"),type:"error",duration:2e3}),!1})},B=()=>{if(l.origin.length===0){te({message:"\u8BF7\u5148\u9009\u62E9\u539F\u5E93\u533A\uFF01",type:"warning"});return}l.production.length>=5||l.production.push({productionID:"",productionName:"",quantity:0,unit:""})},P=(u,t)=>{t&&l.production.splice(0),l.production.splice(u,1)},F=x({}),$=async u=>{const{code:t,data:s}=await oe(u);t===2e4&&Object.assign(F,s)},S=u=>{P(0,!0),B(),$(u)},G=(u,t)=>{Object.assign(l.production[t],F[u])},Y=async()=>{const u=await ue(+g.query.id);u.code===2e4&&Object.assign(l,u.data)};return g.query.id&&Y().then(()=>$(l.origin)),(u,t)=>{const s=i("el-input"),c=i("el-form-item"),p=i("el-col"),Z=i("el-tag"),q=i("el-option"),h=i("el-select"),V=i("el-row"),D=i("el-button"),y=i("el-table-column"),H=i("el-table"),J=i("el-form");return d(),k("div",se,[f("div",ie,[f("span",null,_(n(g).query.id?n(o)("transfer.update"):n(o)("transfer.create")),1)]),e(J,{ref_key:"orderFormRef",ref:O,model:l,rules:T,class:"form-container"},{default:a(()=>[f("div",de,[e(V,null,{default:a(()=>[e(p,{span:24},{default:a(()=>[f("div",ce,[e(V,null,{default:a(()=>[e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.orderID")+" :",class:"postInfo-container-item",prop:"orderID"},{default:a(()=>[e(s,{modelValue:l.orderID,"onUpdate:modelValue":t[0]||(t[0]=r=>l.orderID=r),placeholder:n(o)("AutoGeneration")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.origin")+" :",class:"postInfo-container-item",prop:"origin"},{default:a(()=>[n(g).query.id?(d(),I(Z,{key:0},{default:a(()=>[v(_(l.origin),1)]),_:1})):(d(),I(h,{key:1,modelValue:l.origin,"onUpdate:modelValue":t[1]||(t[1]=r=>l.origin=r),placeholder:"",onChange:S},{default:a(()=>[(d(!0),k(C,null,A(n(N),r=>(d(),I(q,{key:r.key,label:r.label,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.new")+" :",class:"postInfo-container-item",prop:"new"},{default:a(()=>[e(h,{modelValue:l.new,"onUpdate:modelValue":t[2]||(t[2]=r=>l.new=r),placeholder:""},{default:a(()=>[(d(!0),k(C,null,A(n(N),r=>(d(),I(q,{key:r.key,label:r.label,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.documenter")+" :",class:"postInfo-container-item",prop:"documenter"},{default:a(()=>[e(s,{modelValue:l.documenter,"onUpdate:modelValue":t[3]||(t[3]=r=>l.documenter=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.batch")+" :",class:"postInfo-container-item",prop:"batch"},{default:a(()=>[e(s,{modelValue:l.batch,"onUpdate:modelValue":t[4]||(t[4]=r=>l.batch=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:a(()=>[e(c,{label:n(o)("transfer.correlationID")+" :",class:"postInfo-container-item",prop:"correlationID"},{default:a(()=>[e(s,{modelValue:l.correlationID,"onUpdate:modelValue":t[5]||(t[5]=r=>l.correlationID=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(V,null,{default:a(()=>[e(p,{span:20},{default:a(()=>[e(c,{label:n(o)("transfer.remark")+":",class:"postInfo-container-remark",prop:"remark"},{default:a(()=>[e(s,{modelValue:l.remark,"onUpdate:modelValue":t[6]||(t[6]=r=>l.remark=r),rows:4,type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})])]),_:1})]),_:1})]),f("div",pe,[f("span",null,_(n(o)("transfer.productionInfo")),1),e(D,{type:"success",onClick:B},{default:a(()=>[v(_(n(o)("button.createProduction")),1)]),_:1})]),e(c,{prop:"production"},{default:a(()=>[e(H,{data:l.production,border:"",fit:"","header-cell-class-name":"table_header",class:"production"},{default:a(()=>[e(y,{"min-width":"100px",label:n(o)("transfer.productionID"),align:"center"},{default:a(({row:r,$index:E})=>[e(h,{modelValue:r.productionID,"onUpdate:modelValue":m=>r.productionID=m,placeholder:"",filterable:"",remote:"",onChange:m=>G(r.productionID,E)},{default:a(()=>[(d(!0),k(C,null,A(Object.keys(F),m=>(d(),I(q,{key:m,label:m,value:m},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),e(y,{"min-width":"100px",label:n(o)("transfer.productionName"),align:"center",prop:"productionName"},null,8,["label"]),e(y,{"min-width":"80px",label:n(o)("transfer.quantity"),align:"center",prop:"quantity"},null,8,["label"]),e(y,{"min-width":"80px",label:n(o)("transfer.unit"),align:"center",prop:"unit"},null,8,["label"]),e(y,{label:n(o)("transfer.actions"),align:"center","min-width":"50","class-name":"small-padding fixed-width"},{default:a(({row:r,$index:E})=>[e(D,{type:"danger",size:"small",onClick:m=>P(E)},{default:a(()=>[v(_(n(o)("button.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1}),f("div",me,[e(D,{type:"primary",size:"large",onClick:t[7]||(t[7]=r=>z(O.value))},{default:a(()=>[v(_(n(o)("button.submit")),1)]),_:1}),e(D,{size:"large",onClick:t[8]||(t[8]=r=>n(U).go(-1))},{default:a(()=>[v(_(n(o)("button.cancel")),1)]),_:1})])]),_:1},8,["model","rules"])])}}});const ye=ae(fe,[["__scopeId","data-v-c1fa13f3"]]);export{ye as default};
