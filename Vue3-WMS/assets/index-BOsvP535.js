import{T as R,d as m,r as g,V as L,o as E,Y as F,Z as M,g as z,i as d,L as $,$ as H,x as V,_ as q,f as B,n as w,l as p,j as k,t as C,k as A,J as N,K as O}from"./index-Dpah9Y0-.js";function P(){return R.postRequest("/waterfall/imgList")}function S(){return R.postRequest("/waterfall/comp")}async function T(){return(await P()).data.map(t=>t.url)}async function U(){return(await S()).data}const j=m({__name:"index",props:{minGap:{default:10},width:{default:220},timeout:{default:0},fill:{type:Boolean,default:!1}},setup(l){const t=l,n=g(),h=L(i,.5*1e3),r=new ResizeObserver(()=>{h()});async function i(){if(!n.value)return;const a=n.value.children;if(a.length===0)return;await D();const e=Array.from(a).map(s=>H(s,t.timeout));await Promise.all(e),await V(),G()}const f=L(async function(){await i()},300,!1),u=()=>{window.addEventListener("resize",f)},y=()=>{if(!n.value)return;const a=n.value.children;for(let e=0;e<a.length;e++)r.observe(a[e])},D=async()=>{if(!n.value)return;const{itemWidth:a}=x(),e=n.value.children;for(let s=0;s<e.length;s++){const o=e[s];o.style.width=a+"px",o.style.position="absolute",o.style.transition="all 0.3s"}},G=()=>{if(!n.value)return;const{number:a,gap:e,itemWidth:s}=x(),o=new Array(a).fill(0),c=n.value.children;for(let _=0;_<c.length;_++){const v=c[_],b=Math.min(...o);v.style.top=b+"px";const W=o.indexOf(b);o[W]+=v.clientHeight+t.minGap,v.style.left=W*(s+e)+"px"}const I=n.value;I.style.height=Math.max(...o)+"px"},x=()=>{const a=n.value;if(!a)return{containerWidth:0,gap:0,number:0,itemWidth:0};const e=a.clientWidth,s=Math.floor((e+t.minGap)/(t.width+t.minGap));if(t.fill){const o=t.minGap,c=(e-(s-1)*o)/s;return{containerWidth:e,gap:o,number:s,itemWidth:c}}else{const o=t.width,c=(e-o*s)/(s-1);return{containerWidth:e,gap:c,number:s,itemWidth:o}}};return E(()=>{u(),i(),y()}),F(()=>{i(),y()}),M(()=>{window.removeEventListener("resize",f),r.disconnect()}),(a,e)=>(d(),z("div",{ref_key:"rootRef",ref:n,class:"waterfall-container"},[$(a.$slots,"default",{},void 0,!0)],512))}}),J=q(j,[["__scopeId","data-v-e26f211e"]]),K=m({__name:"Comment",props:{title:{},desc:{}},setup(l){const t=l;return(n,h)=>{const r=B("el-card");return d(),w(r,null,{header:p(()=>[k("span",null,C(t.title),1)]),default:p(()=>[k("p",null,C(t.desc),1)]),_:1})}}}),Y=m({name:"WaterFall"}),Q=m({...Y,setup(l){const t=g([]),n=g([]);return(async()=>{const r=await T();t.value=r;const i=await U();n.value=i})(),(r,i)=>{const f=B("el-scrollbar");return d(),w(f,{height:"calc(100vh - 90px)"},{default:p(()=>[A(J,{"min-gap":10,width:220,fill:""},{default:p(()=>[(d(!0),z(N,null,O(n.value,u=>(d(),w(K,{key:u.title,title:u.title,desc:u.desc},null,8,["title","desc"]))),128))]),_:1})]),_:1})}}});export{Q as default};
