import{d as X,u as H,a as Y,b as Z,e as U,r as ee,f as u,g as w,i as d,j as f,k as e,t as _,m as o,l,n as I,s as V,J as N,K as O,W as F,Q as R,C as D,X as te,_ as le}from"./index-Dpah9Y0-.js";import{u as ae,d as re,e as oe,f as ne,a as se}from"./useMap-D68e03y-.js";const ie={class:"createPost-container"},ue={class:"title"},de={class:"createPost-main-container"},ce={class:"postInfo-container"},pe={class:"title"},me={class:"submit_order_button"},fe=X({__name:"index",setup(_e){const g=H(),P=Y(),{t:n}=Z(),{area:$}=ae(),b=(s,t)=>n(`transfer.${s}`)+" "+n(`${t}`),z=(s,t,i)=>{F(t,a.origin)?i(new Error("新库区不能与原库区相同！！")):i()},L=(s,t,i)=>{F(t,a.new)?i(new Error("原库区不能新库区与相同！！")):i()},M=U({origin:[{required:!0,message:b("origin","require"),trigger:"blur"},{required:!0,validator:L,trigger:"change"}],new:[{required:!0,message:b("new","require"),trigger:"blur"},{required:!0,validator:z,trigger:"change"}],correlationID:[{required:!0,message:b("correlationID","require"),trigger:"blur"}],batch:[{required:!0,message:b("batch","require"),trigger:"blur"}],documenter:[{required:!0,message:b("documenter","require"),trigger:"blur"}]}),j=ee(),a=U({orderID:"",correlationID:"",timestamp:"",batch:"",origin:"",new:"",documenter:"",remark:"",production:[]}),S=s=>{s&&s.validate(async t=>{if(t)(g.query.id?await re(a):await oe(a)).code===2e4&&(R({title:"Success",message:D.global.t("tips.submit")+D.global.t("tips.success"),type:"success",duration:2e3}),P.go(-1));else return R({title:"Error",message:D.global.t("tips.submit")+D.global.t("tips.fail"),type:"error",duration:2e3}),!1})},A=()=>{if(a.origin.length===0){te({message:"请先选择原库区！",type:"warning"});return}a.production.length>=5||a.production.push({productionID:"",productionName:"",quantity:0,unit:""})},E=(s,t)=>{t&&a.production.splice(0),a.production.splice(s,1)},h=U({}),B=async s=>{const{code:t,data:i}=await ne(s);t===2e4&&Object.assign(h,i)},T=s=>{E(0,!0),A(),B(s)},G=(s,t)=>{Object.assign(a.production[t],h[s])},J=async()=>{const s=await se(+g.query.id);s.code===2e4&&Object.assign(a,s.data)};return g.query.id&&J().then(()=>B(a.origin)),(s,t)=>{const i=u("el-input"),c=u("el-form-item"),p=u("el-col"),K=u("el-tag"),q=u("el-option"),x=u("el-select"),v=u("el-row"),k=u("el-button"),y=u("el-table-column"),Q=u("el-table"),W=u("el-form");return d(),w("div",ie,[f("div",ue,[f("span",null,_(o(g).query.id?o(n)("transfer.update"):o(n)("transfer.create")),1)]),e(W,{ref_key:"orderFormRef",ref:j,model:a,rules:M,class:"form-container"},{default:l(()=>[f("div",de,[e(v,null,{default:l(()=>[e(p,{span:24},{default:l(()=>[f("div",ce,[e(v,null,{default:l(()=>[e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.orderID")+" :",class:"postInfo-container-item",prop:"orderID"},{default:l(()=>[e(i,{modelValue:a.orderID,"onUpdate:modelValue":t[0]||(t[0]=r=>a.orderID=r),placeholder:o(n)("AutoGeneration")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.origin")+" :",class:"postInfo-container-item",prop:"origin"},{default:l(()=>[o(g).query.id?(d(),I(K,{key:0},{default:l(()=>[V(_(a.origin),1)]),_:1})):(d(),I(x,{key:1,modelValue:a.origin,"onUpdate:modelValue":t[1]||(t[1]=r=>a.origin=r),placeholder:"",onChange:T},{default:l(()=>[(d(!0),w(N,null,O(o($),r=>(d(),I(q,{key:r.key,label:r.label,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.new")+" :",class:"postInfo-container-item",prop:"new"},{default:l(()=>[e(x,{modelValue:a.new,"onUpdate:modelValue":t[2]||(t[2]=r=>a.new=r),placeholder:""},{default:l(()=>[(d(!0),w(N,null,O(o($),r=>(d(),I(q,{key:r.key,label:r.label,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.documenter")+" :",class:"postInfo-container-item",prop:"documenter"},{default:l(()=>[e(i,{modelValue:a.documenter,"onUpdate:modelValue":t[3]||(t[3]=r=>a.documenter=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.batch")+" :",class:"postInfo-container-item",prop:"batch"},{default:l(()=>[e(i,{modelValue:a.batch,"onUpdate:modelValue":t[4]||(t[4]=r=>a.batch=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(p,{span:8},{default:l(()=>[e(c,{label:o(n)("transfer.correlationID")+" :",class:"postInfo-container-item",prop:"correlationID"},{default:l(()=>[e(i,{modelValue:a.correlationID,"onUpdate:modelValue":t[5]||(t[5]=r=>a.correlationID=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),e(v,null,{default:l(()=>[e(p,{span:20},{default:l(()=>[e(c,{label:o(n)("transfer.remark")+":",class:"postInfo-container-remark",prop:"remark"},{default:l(()=>[e(i,{modelValue:a.remark,"onUpdate:modelValue":t[6]||(t[6]=r=>a.remark=r),rows:4,type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})])]),_:1})]),_:1})]),f("div",pe,[f("span",null,_(o(n)("transfer.productionInfo")),1),e(k,{type:"success",onClick:A},{default:l(()=>[V(_(o(n)("button.createProduction")),1)]),_:1})]),e(c,{prop:"production"},{default:l(()=>[e(Q,{data:a.production,border:"",fit:"","header-cell-class-name":"table_header",class:"production"},{default:l(()=>[e(y,{"min-width":"100px",label:o(n)("transfer.productionID"),align:"center"},{default:l(({row:r,$index:C})=>[e(x,{modelValue:r.productionID,"onUpdate:modelValue":m=>r.productionID=m,placeholder:"",filterable:"",remote:"",onChange:m=>G(r.productionID,C)},{default:l(()=>[(d(!0),w(N,null,O(Object.keys(h),m=>(d(),I(q,{key:m,label:m,value:m},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["label"]),e(y,{"min-width":"100px",label:o(n)("transfer.productionName"),align:"center",prop:"productionName"},null,8,["label"]),e(y,{"min-width":"80px",label:o(n)("transfer.quantity"),align:"center",prop:"quantity"},null,8,["label"]),e(y,{"min-width":"80px",label:o(n)("transfer.unit"),align:"center",prop:"unit"},null,8,["label"]),e(y,{label:o(n)("transfer.actions"),align:"center","min-width":"50","class-name":"small-padding fixed-width"},{default:l(({row:r,$index:C})=>[e(k,{type:"danger",size:"small",onClick:m=>E(C)},{default:l(()=>[V(_(o(n)("button.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1}),f("div",me,[e(k,{type:"primary",size:"large",onClick:t[7]||(t[7]=r=>S(j.value))},{default:l(()=>[V(_(o(n)("button.submit")),1)]),_:1}),e(k,{size:"large",onClick:t[8]||(t[8]=r=>o(P).go(-1))},{default:l(()=>[V(_(o(n)("button.cancel")),1)]),_:1})])]),_:1},8,["model","rules"])])}}}),ye=le(fe,[["__scopeId","data-v-f2c0cc7b"]]);export{ye as default};
