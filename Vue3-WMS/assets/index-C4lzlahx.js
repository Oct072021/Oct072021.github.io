const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Export2Excel-ofprALJd.js","./index-Dpah9Y0-.js","./index-BfXC0mqM.css"])))=>i.map(i=>d[i]);
import{d as ee,b as te,w as ae,e as j,r as v,f as u,g as A,i as k,H as _e,I as be,k as e,l as t,m as a,j as le,t as s,O as se,s as n,n as M,P as J,Q as oe,C as B,a as fe,u as ye,J as X,K as ve,R as ge,x as Y,S as he,_ as ke}from"./index-Dpah9Y0-.js";import{u as ne,g as we,r as xe,a as Z,b as De,c as Ce}from"./useMap-DkwO-FJq.js";import{M as Ve,_ as Ie,t as $e}from"./common-DKgXSvSS.js";const Oe=ee({__name:"TabPane",props:{area:{default:"area-1"},searchList:{default:()=>({status:void 0,type:void 0,orderID:void 0})}},emits:["create","handleUpdate","toDetail","handleAudit"],setup(K,{expose:r,emit:$}){const{t:i}=te(),O=K,w=$;ae(()=>O.searchList,p=>{Object.assign(_,p),D()},{deep:!0});const{typeMap:F,statusMap:N}=ne(),U=v(null),_=j({page:1,limit:10,type:void 0,status:void 0,orderID:void 0,area:O.area}),T=v(!1),x=v(0),D=async p=>{p&&Object.assign(_,p),T.value=!0;const I=await we(_);U.value=I.data.items,T.value=!1,x.value=I.data.total,w("create")};D();const L=p=>{w("handleUpdate",p)},z=async p=>{(await xe(p)).code===2e4&&(oe({title:"Success",message:B.global.t("tips.delete")+B.global.t("tips.success"),type:"success",duration:2e3}),D())},R=p=>{w("toDetail",p)},S=p=>{w("handleAudit",p)};return r({getList:D}),(p,I)=>{const b=u("el-table-column"),C=u("el-tag"),f=u("el-button"),d=u("el-table");return k(),A("div",null,[_e(e(Ve,{total:x.value,page:_.page,limit:_.limit,onPagination:D},{table:t(()=>[e(d,{data:U.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"},draggable:""},{default:t(()=>[e(b,{"min-width":"130px",label:a(i)("orders.orderID"),prop:"orderID",align:"center"},null,8,["label"]),e(b,{"min-width":"130px",label:a(i)("orders.title"),align:"center",prop:"title"},null,8,["label"]),e(b,{"min-width":"120px",align:"center",label:a(i)("orders.date")},{default:t(({row:m})=>[le("span",null,s(a(se)(m.timestamp,"{y}-{m}-{d}")),1)]),_:1},8,["label"]),e(b,{"class-name":"status-col",label:a(i)("orders.type"),"min-width":"120"},{default:t(({row:m})=>[n(s(a(F)[m.type]),1)]),_:1},8,["label"]),e(b,{"class-name":"status-col",label:a(i)("orders.client"),prop:"client","min-width":"110"},null,8,["label"]),e(b,{"class-name":"status-col",label:a(i)("orders.documenter"),prop:"documenter","min-width":"120"},null,8,["label"]),e(b,{"class-name":"status-col",label:a(i)("orders.status"),"min-width":"120"},{default:t(({row:m})=>[e(C,{type:a(N)[m.status].type},{default:t(()=>[n(s(a(N)[m.status].label),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(b,{"class-name":"status-col",label:a(i)("orders.auditor"),"min-width":"110",prop:"auditor"},null,8,["label"]),e(b,{label:a(i)("orders.actions"),align:"center","min-width":"270","class-name":"small-padding fixed-width"},{default:t(({row:m})=>[e(f,{type:"info",size:"small",onClick:P=>R(m.id)},{default:t(()=>[n(s(a(i)("button.detail")),1)]),_:2},1032,["onClick"]),e(f,{type:"primary",size:"small",onClick:P=>L(m.id)},{default:t(()=>[n(s(a(i)("button.edit")),1)]),_:2},1032,["onClick"]),m.status===0?(k(),M(f,{key:0,size:"small",type:"warning",onClick:P=>S(m.id)},{default:t(()=>[n(s(a(i)("button.audit")),1)]),_:2},1032,["onClick"])):J("",!0),e(f,{size:"small",type:"danger",onClick:P=>z(m.id)},{default:t(()=>[n(s(a(i)("button.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["total","page","limit"]),[[be,x.value>0]])])}}}),Te={class:"tab-container"},Pe={key:1},Ae={class:"dialog-footer"},Me=ee({__name:"index",setup(K){const{t:r}=te(),$=fe(),i=ye(),{typeMap:O,statusMap:w,titleMap:F,area:N,header:U}=ne(),_=v("area-1");ae(_,c=>{$.push(`${i.path}?tab=${c}`)});const T=i.query.tab;T&&(_.value=T);const x=j({type:void 0,orderID:void 0,status:void 0}),D=(c,l)=>{switch(l){case"search":Object.assign(x,{...x,...c});break;case"add":m();break;case"export":p();break}},L=v(0),z=()=>{L.value++},R=v(null),S=v(!1),p=$e(async function(){S.value=!0;const c=await Ce(_.value);R.value=c.data,he(()=>import("./Export2Excel-ofprALJd.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(l=>{const y=["orderID","title","data","type","client","documenter","status","auditor"],E=I(["orderID","title","timestamp","type","client","documenter","status","auditor"]);l.export_json_to_excel({header:y,data:E,filename:`outbound-list-${_.value}`}),S.value=!1})},5*1e3),I=c=>R.value.map(l=>c.map(y=>{switch(y){case"timestamp":return se(l[y],"{y}-{m}-{d}");case"type":return O[l[y]];case"status":return w[l[y]].label;default:return l[y]}})),b=v(),C=v(""),f=v(!1),d=j({id:-1,orderID:"",status:-1,area:"",type:-1,timestamp:"",client:"",documenter:"",number:void 0,remark:"",contact:"",reason:"",production:[],auditor:""}),m=()=>{$.push({path:"/order/outbound/create_update"})},P=c=>{$.push({path:"/order/outbound/create_update",query:{id:c}})},re=async c=>{const l=await Z(c);Object.assign(d,l.data),C.value="detail",f.value=!0,Y(()=>{b.value.clearValidate()})},Q=v(),de=async c=>{const l=await Z(c);Object.assign(d,l.data),C.value="audit",f.value=!0,Y(()=>{b.value.clearValidate()})},G=async(c,l)=>{(await De({detail:c,status:l})).code===2e4&&(f.value=!1,oe({title:"Success",message:B.global.t("tips.audit")+B.global.t("tips.success"),type:"success",duration:2e3}),Q.value[0].getList())};return(c,l)=>{const y=u("el-tag"),W=u("el-alert"),E=u("el-tab-pane"),ue=u("el-tabs"),g=u("el-form-item"),h=u("el-col"),q=u("el-row"),ie=u("el-input"),V=u("el-table-column"),ce=u("el-table"),pe=u("el-form"),H=u("el-button"),me=u("el-dialog");return k(),A("div",Te,[e(y,null,{default:t(()=>[n("mounted times : "+s(L.value),1)]),_:1}),e(W,{closable:!1,style:{width:"200px",display:"inline-block","vertical-align":"middle","margin-left":"30px"},title:"Tab with keep-alive",type:"success"}),e(Ie,{"config-data":a(U),onButtonClick:D},null,8,["config-data"]),e(ue,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=o=>_.value=o),style:{"margin-top":"15px"},type:"border-card"},{default:t(()=>[(k(!0),A(X,null,ve(a(N),o=>(k(),M(E,{key:o.key,label:o.label,name:o.key},{default:t(()=>[(k(),M(ge,null,[_.value==o.key?(k(),M(Oe,{ref_for:!0,ref_key:"TabPaneRef",ref:Q,key:o.key,area:o.key,"search-list":x,onCreate:z,onHandleUpdate:P,onToDetail:re,onHandleAudit:de},null,8,["area","search-list"])):J("",!0)],1024))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"]),e(me,{title:a(F)[C.value],modelValue:f.value,"onUpdate:modelValue":l[5]||(l[5]=o=>f.value=o),"align-center":"",width:"900px"},{footer:t(()=>[le("div",Ae,[C.value==="audit"?(k(),A(X,{key:0},[e(H,{type:"success",onClick:l[2]||(l[2]=o=>G(d,1))},{default:t(()=>[n(s(a(r)("button.pass")),1)]),_:1}),e(H,{type:"danger",onClick:l[3]||(l[3]=o=>G(d,2))},{default:t(()=>[n(s(a(r)("button.noPass")),1)]),_:1})],64)):J("",!0),e(H,{onClick:l[4]||(l[4]=o=>f.value=!1)},{default:t(()=>[n(s(a(r)("button.cancel")),1)]),_:1})])]),default:t(()=>[e(pe,{ref_key:"dataForm",ref:b,model:d,"label-position":"left"},{default:t(()=>[e(q,{gutter:20},{default:t(()=>[e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.orderID")+":",prop:"orderID"},{default:t(()=>[n(s(d.orderID),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.type")+":",prop:"type"},{default:t(()=>[n(s(a(O)[d.type]),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.status")+":",prop:"status"},{default:t(()=>[e(y,{type:a(w)[d.status].type},{default:t(()=>[n(s(a(w)[d.status].label),1)]),_:1},8,["type"])]),_:1},8,["label"])]),_:1})]),_:1}),e(q,{gutter:20},{default:t(()=>[e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.client")+":",prop:"client"},{default:t(()=>[n(s(d.client),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.contact")+":",prop:"contact"},{default:t(()=>[n(s(d.contact),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.number")+":",prop:"number"},{default:t(()=>[n(s(d.number),1)]),_:1},8,["label"])]),_:1})]),_:1}),e(q,{gutter:20},{default:t(()=>[e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.documenter")+":",prop:"documenter"},{default:t(()=>[n(s(d.documenter),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.date")+":",prop:"timestamp"},{default:t(()=>[n(s(d.timestamp),1)]),_:1},8,["label"])]),_:1}),e(h,{span:8},{default:t(()=>[e(g,{label:a(r)("orders.remark")+":",prop:"remark"},{default:t(()=>[n(s(d.remark),1)]),_:1},8,["label"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(h,{span:20},{default:t(()=>[e(g,{label:a(r)("orders.reason")+":",prop:"reason"},{default:t(()=>[C.value==="audit"?(k(),M(ie,{key:0,modelValue:d.reason,"onUpdate:modelValue":l[1]||(l[1]=o=>d.reason=o),rows:3,type:"textarea"},null,8,["modelValue"])):(k(),A("span",Pe,s(d.reason),1))]),_:1},8,["label"])]),_:1})]),_:1}),e(ce,{data:d.production,border:"",fit:"","highlight-current-row":"","header-cell-class-name":"table_header",style:{width:"100%"}},{default:t(()=>[e(V,{"min-width":"100px",label:a(r)("orders.productionID"),align:"center",prop:"productionID"},null,8,["label"]),e(V,{"min-width":"100px",label:a(r)("orders.productionName"),align:"center",prop:"productionName"},null,8,["label"]),e(V,{align:"center",label:a(r)("orders.specs"),"min-width":"95"},{default:t(({row:o})=>[n(s(`${o.specs1} × ${o.specs2}`),1)]),_:1},8,["label"]),e(V,{"class-name":"status-col",label:a(r)("orders.price"),prop:"price","min-width":"80"},null,8,["label"]),e(V,{"class-name":"status-col",label:a(r)("orders.quantity"),"min-width":"80"},{default:t(({row:o})=>[n(s(o.quantity+" /件"),1)]),_:1},8,["label"]),e(V,{"class-name":"status-col",label:a(r)("orders.total"),"min-width":"90"},{default:t(({row:o})=>[n(s((o.price*o.quantity).toFixed(2)),1)]),_:1},8,["label"]),e(V,{"class-name":"status-col",label:a(r)("area"),"min-width":"105"},{default:t(()=>[n(s(d.area),1)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),Re=ke(Me,[["__scopeId","data-v-b1207f25"]]);export{Re as default};
