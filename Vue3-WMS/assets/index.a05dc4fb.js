import{P as S,d as te,b as ae,e as I,r as g,w as le,k as c,Y as se,n as y,f as $,g as a,j as n,J as B,K as oe,i as l,q as C,m as O,t as m,x as p,S as ne,L as ie,M as re,z as de,T as P,E,V as ue,R as ce}from"./index.fdcd0fff.js";import{_ as pe,M as me,t as ge}from"./common.05076652.js";function fe(d){return S.getRequest("/vue-element-admin/stock/list",{params:d})}function _e(d){return S.postRequest("/vue-element-admin/stock/update",d)}function be(d){return S.postRequest("/vue-element-admin/stock/remove",{id:d})}async function ye(d){return await fe(d)}function ve(d){return _e(d)}function ke(d){return be(d)}const qe=[{type:"input",name:"title",styles:{width:"200px"},event:"search"},{type:"select",name:"area",styles:{width:"140px"},options:[{key:"area-1",label:"area-1"},{key:"area-2",label:"area-2"},{key:"area-3",label:"area-3"},{key:"area-4",label:"area-4"}]},{type:"select",name:"sort",styles:{width:"150px"},options:[{label:"ID Ascending",key:"+id"},{label:"ID Descending",key:"-id"}]},{type:"button",name:"Search",buttonType:"primary",icon:"search",styles:{margin:"0 10px 0 0"},event:"search"},{type:"button",name:"Export",buttonType:"primary",icon:"download",styles:{margin:"0 10px 0 0"},event:"export"}],Ve={class:"app-container"},he=["onClick"],xe={class:"dialog-footer"},Ie=te({__name:"index",setup(d){const{t:o}=ae(),F=I({area:[{required:!0,message:"area is required",trigger:"change"}],orderID:[{required:!0,message:"orderID is required",trigger:"blur"}],title:[{required:!0,message:"title is required",trigger:"blur"}],specs:[{required:!0,message:"specs is required",trigger:"blur"}],quantity:[{required:!0,message:"quantity is required",trigger:"blur"}],mass:[{required:!0,message:"mass is required",trigger:"blur"}]}),M=g([{key:"area-1",display_name:"area-1"},{key:"area-2",display_name:"area-2"},{key:"area-3",display_name:"area-3"},{key:"area-4",display_name:"area-4"}]),N=(s,e)=>{e==="search"?(Object.assign(u,{...u,...s}),h()):e==="export"&&K()},u=I({page:1,limit:20,title:void 0,area:void 0,sort:"+id"});le(u,()=>{h()},{deep:!0});const h=()=>{u.page=1,_()},v=g(null),x=g(0),w=g(!1),_=async()=>{w.value=!0;const s=await ye(u);v.value=s.data.items,x.value=s.data.total,setTimeout(()=>{w.value=!1},1*1e3)},R=({prop:s,order:e})=>{s==="id"&&j(e)},j=s=>{s==="ascending"?u.sort="+id":u.sort="-id",h()},z=function(s){return u.sort===`+${s}`?"ascending":"descending"},i=I({id:void 0,orderID:"",specs:void 0,quantity:void 0,title:"",area:"",mass:void 0}),A=()=>{Object.assign(i,{id:void 0,orderID:"",specs:void 0,quantity:void 0,title:"",area:"",mass:void 0})},D=g(),b=g(!1),T=s=>{A(),b.value=!0,Object.assign(i,s),de(()=>{D.value.clearValidate()})},H=s=>{!s||s.validate(async e=>{if(e){const r=Object.assign({},i);(await ve(r)).code===2e4&&(b.value=!1,P({title:"Success",message:E.global.t("tips.updateMsg_success"),type:"success",duration:2e3}),_())}})},J=async s=>{(await ke(s)).code===2e4&&(P({title:"Success",message:E.global.t("tips.deleteMsg_success"),type:"success",duration:2e3}),_())},L=g(!1),K=ge(function(){L.value=!0,ue(()=>import("./Export2Excel.df3d1516.js"),["./Export2Excel.df3d1516.js","./index.fdcd0fff.js","./index.0a15a48e.css"],import.meta.url).then(s=>{const e=["orderID","title","specs","quantity","mass"],k=Q(["orderID","title","specs","quantity","mass"]);s.export_json_to_excel({header:e,data:k,filename:"stock"}),L.value=!1})},5*1e3),Q=s=>{if(!!v.value)return v.value.map(e=>s.map(r=>r==="timestamp"?ce(e[r]):e[r]))};return _(),(s,e)=>{const r=c("el-table-column"),k=c("el-tag"),q=c("el-button"),Y=c("el-table"),G=c("el-option"),W=c("el-select"),f=c("el-form-item"),V=c("el-input"),X=c("el-form"),Z=c("el-dialog"),ee=se("loading");return y(),$("div",Ve,[a(pe,{"config-data":n(qe),onButtonClick:N},null,8,["config-data"]),B(a(me,{total:x.value,page:u.page,limit:u.limit,onPagination:_},{table:l(()=>[B((y(),C(Y,{data:v.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"},onSortChange:R},{default:l(()=>[a(r,{label:"#",prop:"id",sortable:"custom",align:"center",width:"80","class-name":z("id")},null,8,["class-name"]),a(r,{label:n(o)("stock.orderID"),prop:"orderID",width:"200px",align:"center"},null,8,["label"]),a(r,{label:n(o)("stock.title"),"min-width":"200px"},{default:l(({row:t})=>[O("span",{class:"link-type",onClick:U=>T(t)},m(t.title),9,he),a(k,null,{default:l(()=>[p(m(t.area),1)]),_:2},1024)]),_:1},8,["label"]),a(r,{label:n(o)("stock.specs"),width:"120px",align:"center"},{default:l(({row:t})=>[p(m(t.specs)+"mm ",1)]),_:1},8,["label"]),a(r,{label:n(o)("stock.quantity"),width:"110px",align:"center",prop:"quantity"},null,8,["label"]),a(r,{label:n(o)("stock.mass"),width:"120px",align:"center"},{default:l(({row:t})=>[p(m(t.mass)+"kg ",1)]),_:1},8,["label"]),a(r,{label:n(o)("stock.actions"),align:"center",width:"230","class-name":"small-padding fixed-width"},{default:l(({row:t})=>[a(q,{type:"primary",size:"small",onClick:U=>T(t)},{default:l(()=>[p(m(n(o)("button.edit")),1)]),_:2},1032,["onClick"]),t.status!="deleted"?(y(),C(q,{key:0,size:"small",type:"danger",onClick:U=>J(t.id)},{default:l(()=>[p(m(n(o)("button.delete")),1)]),_:2},1032,["onClick"])):ne("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[ee,w.value]])]),_:1},8,["total","page","limit"]),[[oe,x.value>0]]),a(Z,{title:n(o)("button.edit"),modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=t=>b.value=t),"align-center":""},{footer:l(()=>[O("div",xe,[a(q,{onClick:e[5]||(e[5]=t=>b.value=!1)},{default:l(()=>[p(m(n(o)("button.cancel")),1)]),_:1}),a(q,{type:"primary",onClick:e[6]||(e[6]=t=>H(D.value))},{default:l(()=>[p(m(n(o)("button.confirm")),1)]),_:1})])]),default:l(()=>[a(X,{ref_key:"dataForm",ref:D,rules:F,model:i,"label-position":"left","label-width":"110px",style:{width:"400px","margin-left":"50px"}},{default:l(()=>[a(f,{label:n(o)("stock.warehouse"),prop:"area"},{default:l(()=>[a(W,{modelValue:i.area,"onUpdate:modelValue":e[0]||(e[0]=t=>i.area=t),class:"filter-item",placeholder:"Please select"},{default:l(()=>[(y(!0),$(ie,null,re(M.value,t=>(y(),C(G,{key:t.key,label:t.display_name,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(f,{label:n(o)("stock.orderID"),prop:"orderID"},{default:l(()=>[p(m(i.orderID),1)]),_:1},8,["label"]),a(f,{label:n(o)("stock.title"),prop:"title"},{default:l(()=>[a(V,{modelValue:i.title,"onUpdate:modelValue":e[1]||(e[1]=t=>i.title=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(f,{label:n(o)("stock.specs"),prop:"specs"},{default:l(()=>[a(V,{modelValue:i.specs,"onUpdate:modelValue":e[2]||(e[2]=t=>i.specs=t)},{append:l(()=>[p("mm")]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(f,{label:n(o)("stock.quantity"),prop:"quantity"},{default:l(()=>[a(V,{modelValue:i.quantity,"onUpdate:modelValue":e[3]||(e[3]=t=>i.quantity=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(f,{label:n(o)("stock.mass"),prop:"mass"},{default:l(()=>[a(V,{modelValue:i.mass,"onUpdate:modelValue":e[4]||(e[4]=t=>i.mass=t)},{append:l(()=>[p("kg")]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}});export{Ie as default};
