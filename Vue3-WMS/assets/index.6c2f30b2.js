import{P as B,E as T,B as M,d as se,b as oe,e as I,r as f,w as ne,k as p,X as re,n as v,f as O,g as a,j as n,J as P,K as ie,i as l,q as S,m as F,t as g,x as m,S as de,L as ue,M as ce,z as pe,T as N,V as me,R as ge}from"./index.d3573972.js";import{_ as fe,M as _e,t as be}from"./common.20ab7f94.js";function ye(r){return B.getRequest("/vue-element-admin/stock/list",{params:r})}function ve(r){return B.postRequest("/vue-element-admin/stock/update",r)}function ke(r){return B.postRequest("/vue-element-admin/stock/remove",{id:r})}async function he(r){return await ye(r)}function qe(r){return ve(r)}function Ve(r){return ke(r)}const{t:u}=T.global,xe=()=>{const r=M(()=>[{key:"area-1",label:u("area")+"-1"},{key:"area-2",label:u("area")+"-2"},{key:"area-3",label:u("area")+"-3"},{key:"area-4",label:u("area")+"-4"}]),s=M(()=>[{type:"input",placeholder:u("stock.title"),name:"title",styles:{width:"200px"},event:"search"},{type:"select",placeholder:u("area"),name:"area",styles:{width:"150px"},options:r.value},{type:"select",placeholder:u("stock.sort"),name:"sort",styles:{width:"150px"},options:[{label:u("ascending"),key:"+id"},{label:u("descending"),key:"-id"}]},{type:"button",name:u("button.search"),buttonType:"primary",icon:"search",styles:{margin:"0 10px 0 0"},event:"search"},{type:"button",name:u("button.export"),buttonType:"primary",icon:"download",styles:{margin:"0 10px 0 0"},event:"export"}]);return{area:r,header:s}},we={class:"app-container"},De=["onClick"],Ce={class:"dialog-footer"},Be=se({__name:"index",setup(r){const{t:s}=oe(),{header:R,area:Ie}=xe(),j=I({area:[{required:!0,message:"area is required",trigger:"change"}],orderID:[{required:!0,message:"orderID is required",trigger:"blur"}],title:[{required:!0,message:"title is required",trigger:"blur"}],specs:[{required:!0,message:"specs is required",trigger:"blur"}],quantity:[{required:!0,message:"quantity is required",trigger:"blur"}],mass:[{required:!0,message:"mass is required",trigger:"blur"}]}),E=f([{key:"area-1",display_name:"area-1"},{key:"area-2",display_name:"area-2"},{key:"area-3",display_name:"area-3"},{key:"area-4",display_name:"area-4"}]),z=(o,e)=>{e==="search"?(Object.assign(c,{...c,...o}),x()):e==="export"&&G()},c=I({page:1,limit:20,title:void 0,area:void 0,sort:"+id"});ne(c,()=>{x()},{deep:!0});const x=()=>{c.page=1,b()},k=f(null),w=f(0),D=f(!1),b=async()=>{D.value=!0;const o=await he(c);k.value=o.data.items,w.value=o.data.total,setTimeout(()=>{D.value=!1},1*1e3)},H=({prop:o,order:e})=>{o==="id"&&J(e)},J=o=>{o==="ascending"?c.sort="+id":c.sort="-id",x()},A=function(o){return c.sort===`+${o}`?"ascending":"descending"},i=I({id:void 0,orderID:"",specs:void 0,quantity:void 0,title:"",area:"",mass:void 0}),K=()=>{Object.assign(i,{id:void 0,orderID:"",specs:void 0,quantity:void 0,title:"",area:"",mass:void 0})},C=f(),y=f(!1),L=o=>{K(),y.value=!0,Object.assign(i,o),pe(()=>{C.value.clearValidate()})},Q=o=>{!o||o.validate(async e=>{if(e){const d=Object.assign({},i);(await qe(d)).code===2e4&&(y.value=!1,N({title:"Success",message:T.global.t("tips.updateMsg_success"),type:"success",duration:2e3}),b())}})},X=async o=>{(await Ve(o)).code===2e4&&(N({title:"Success",message:T.global.t("tips.deleteMsg_success"),type:"success",duration:2e3}),b())},U=f(!1),G=be(function(){U.value=!0,me(()=>import("./Export2Excel.0356de7c.js"),["./Export2Excel.0356de7c.js","./index.d3573972.js","./index.7ac78b4c.css"],import.meta.url).then(o=>{const e=["orderID","title","specs","quantity","mass"],h=W(["orderID","title","specs","quantity","mass"]);o.export_json_to_excel({header:e,data:h,filename:"stock"}),U.value=!1})},5*1e3),W=o=>{if(!!k.value)return k.value.map(e=>o.map(d=>d==="timestamp"?ge(e[d]):e[d]))};return b(),(o,e)=>{const d=p("el-table-column"),h=p("el-tag"),q=p("el-button"),Y=p("el-table"),Z=p("el-option"),ee=p("el-select"),_=p("el-form-item"),V=p("el-input"),te=p("el-form"),ae=p("el-dialog"),le=re("loading");return v(),O("div",we,[a(fe,{"config-data":n(R),onButtonClick:z},null,8,["config-data"]),P(a(_e,{total:w.value,page:c.page,limit:c.limit,onPagination:b},{table:l(()=>[P((v(),S(Y,{data:k.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"},onSortChange:H},{default:l(()=>[a(d,{label:"#",prop:"id",sortable:"custom",align:"center",width:"80","class-name":A("id")},null,8,["class-name"]),a(d,{label:n(s)("stock.orderID"),prop:"orderID",width:"200px",align:"center"},null,8,["label"]),a(d,{label:n(s)("stock.title"),"min-width":"200px"},{default:l(({row:t})=>[F("span",{class:"link-type",onClick:$=>L(t)},g(t.title),9,De),a(h,null,{default:l(()=>[m(g(t.area),1)]),_:2},1024)]),_:1},8,["label"]),a(d,{label:n(s)("stock.specs"),width:"120px",align:"center"},{default:l(({row:t})=>[m(g(t.specs)+"mm ",1)]),_:1},8,["label"]),a(d,{label:n(s)("stock.quantity"),width:"110px",align:"center",prop:"quantity"},null,8,["label"]),a(d,{label:n(s)("stock.mass"),width:"120px",align:"center"},{default:l(({row:t})=>[m(g(t.mass)+"kg ",1)]),_:1},8,["label"]),a(d,{label:n(s)("stock.actions"),align:"center",width:"230","class-name":"small-padding fixed-width"},{default:l(({row:t})=>[a(q,{type:"primary",size:"small",onClick:$=>L(t)},{default:l(()=>[m(g(n(s)("button.edit")),1)]),_:2},1032,["onClick"]),t.status!="deleted"?(v(),S(q,{key:0,size:"small",type:"danger",onClick:$=>X(t.id)},{default:l(()=>[m(g(n(s)("button.delete")),1)]),_:2},1032,["onClick"])):de("",!0)]),_:1},8,["label"])]),_:1},8,["data"])),[[le,D.value]])]),_:1},8,["total","page","limit"]),[[ie,w.value>0]]),a(ae,{title:n(s)("button.edit"),modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=t=>y.value=t),"align-center":""},{footer:l(()=>[F("div",Ce,[a(q,{onClick:e[5]||(e[5]=t=>y.value=!1)},{default:l(()=>[m(g(n(s)("button.cancel")),1)]),_:1}),a(q,{type:"primary",onClick:e[6]||(e[6]=t=>Q(C.value))},{default:l(()=>[m(g(n(s)("button.confirm")),1)]),_:1})])]),default:l(()=>[a(te,{ref_key:"dataForm",ref:C,rules:j,model:i,"label-position":"left","label-width":"110px",style:{width:"400px","margin-left":"50px"}},{default:l(()=>[a(_,{label:n(s)("stock.warehouse"),prop:"area"},{default:l(()=>[a(ee,{modelValue:i.area,"onUpdate:modelValue":e[0]||(e[0]=t=>i.area=t),class:"filter-item",placeholder:"Please select"},{default:l(()=>[(v(!0),O(ue,null,ce(E.value,t=>(v(),S(Z,{key:t.key,label:t.display_name,value:t.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(_,{label:n(s)("stock.orderID"),prop:"orderID"},{default:l(()=>[m(g(i.orderID),1)]),_:1},8,["label"]),a(_,{label:n(s)("stock.title"),prop:"title"},{default:l(()=>[a(V,{modelValue:i.title,"onUpdate:modelValue":e[1]||(e[1]=t=>i.title=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(_,{label:n(s)("stock.specs"),prop:"specs"},{default:l(()=>[a(V,{modelValue:i.specs,"onUpdate:modelValue":e[2]||(e[2]=t=>i.specs=t)},{append:l(()=>[m("mm")]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(_,{label:n(s)("stock.quantity"),prop:"quantity"},{default:l(()=>[a(V,{modelValue:i.quantity,"onUpdate:modelValue":e[3]||(e[3]=t=>i.quantity=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(_,{label:n(s)("stock.mass"),prop:"mass"},{default:l(()=>[a(V,{modelValue:i.mass,"onUpdate:modelValue":e[4]||(e[4]=t=>i.mass=t)},{append:l(()=>[m("kg")]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}});export{Be as default};
